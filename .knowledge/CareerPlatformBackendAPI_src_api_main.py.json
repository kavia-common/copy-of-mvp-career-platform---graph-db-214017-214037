{"is_source_file": true, "format": "Python", "description": "This file defines a FastAPI web server for managing roles and graph-based role adjacency suggestions. It includes route handlers for health checks, role CRUD operations, and role adjacency retrieval, with fallback to in-memory data when the graph feature is disabled.", "external_files": ["src.core.config", "src.graph.graph_client", "src.graph.graph_dal"], "external_methods": ["get_settings", "GraphClient.start", "GraphClient.close", "GraphClient.is_healthy", "GraphDAL.get_role_adjacency", "GraphDAL.get_role_by_id", "GraphDAL.get_roles"], "published": ["create_app", "app"], "classes": [{"name": "RoleModel", "description": "Pydantic model representing a role with optional description fields for API responses."}, {"name": "RoleUpsertModel", "description": "Pydantic model used for creating or updating roles via API payload."}, {"name": "InMemoryRoleDAO", "description": "A simple in-memory data access object for roles, used as a fallback when graph features are disabled or unavailable."}], "methods": [{"name": "Dict[str,Any] upsert(self, payload: RoleUpsertModel)", "description": "Insert or update a role in the in-memory store with COALESCE semantics.", "scope": "InMemoryRoleDAO", "scopeKind": "class"}, {"name": "Optional[Dict[str,Any]] get(self, role_id: str)", "description": "Retrieve a role by its ID from the in-memory store.", "scope": "InMemoryRoleDAO", "scopeKind": "class"}, {"name": "List[Dict[str,Any]] all(self)", "description": "Return all stored roles.", "scope": "InMemoryRoleDAO", "scopeKind": "class"}, {"name": "FastAPI create_app()", "description": "Constructs and configures the FastAPI application, setting up routes, middleware, and startup/shutdown events.", "scope": "", "scopeKind": ""}, {"name": "None __init__(self)", "scope": "InMemoryRoleDAO", "scopeKind": "class", "description": "unavailable"}, {"name": "None _on_shutdown()", "scope": "create_app", "scopeKind": "function", "description": "unavailable"}, {"name": "None _on_startup()", "scope": "create_app", "scopeKind": "function", "description": "unavailable"}, {"name": "RoleModel create_or_upsert_role(payload: RoleUpsertModel)", "scope": "create_app", "scopeKind": "function", "description": "unavailable"}, {"name": "List[RoleModel] get_role_adjacency( userId: Optional[str] = Query( default=None, description=\"Optional user identifier to contextualize suggestions\", ), currentRoleId: Optional[str] = Query( default=None, description=\"Current role id to base adjacency suggestions on\", ), targetRoleId: Optional[str] = Query( default=None, description=\"Optional target role id to bias adjacency results\", ), limit: int = Query(default=20, ge=1, le=100, description=\"Max number of suggestions\"), )", "scope": "create_app", "scopeKind": "function", "description": "unavailable"}, {"name": "RoleModel get_role_by_id(role_id: str)", "scope": "create_app", "scopeKind": "function", "description": "unavailable"}, {"name": "Dict[str,str] health_check()", "scope": "create_app", "scopeKind": "function", "description": "unavailable"}, {"name": "List[RoleModel] list_roles( limit: int = Query(500, ge=1, le=5000, description=\"Max number of roles to return\") )", "scope": "create_app", "scopeKind": "function", "description": "unavailable"}], "calls": ["get_settings", "GraphClient(settings)", "GraphClient.start", "GraphClient.close", "GraphDAL(driver)", "dal.get_role_adjacency", "dal.get_role_by_id", "dal.get_roles", "InMemoryRoleDAO.upsert", "InMemoryRoleDAO.get", "InMemoryRoleDAO.all"], "search-terms": ["role", "graph", "API", "FastAPI", "role-adjacency", "in-memory store", "role CRUD", "health check", "Neo4j"], "state": 2, "file_id": 2, "knowledge_revision": 37, "git_revision": "cfce446adfc5dac943cdef2fc8a393316c20f041", "revision_history": [{"8": "26bae1cdb709a9c5dd2a135e38a87ee57b54a0bd"}, {"18": "26bae1cdb709a9c5dd2a135e38a87ee57b54a0bd"}, {"37": "cfce446adfc5dac943cdef2fc8a393316c20f041"}], "ctags": [{"_type": "tag", "name": "InMemoryRoleDAO", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^class InMemoryRoleDAO:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "RoleModel", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^class RoleModel(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "RoleUpsertModel", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^class RoleUpsertModel(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    def __init__(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "InMemoryRoleDAO", "scopeKind": "class"}, {"_type": "tag", "name": "_on_shutdown", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    def _on_shutdown() -> None:$/", "file": true, "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()", "scope": "create_app", "scopeKind": "function"}, {"_type": "tag", "name": "_on_startup", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    def _on_startup() -> None:$/", "file": true, "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()", "scope": "create_app", "scopeKind": "function"}, {"_type": "tag", "name": "all", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    def all(self) -> List[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:List[Dict[str,Any]]", "kind": "member", "signature": "(self)", "scope": "InMemoryRoleDAO", "scopeKind": "class"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^app = create_app()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "create_app", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^def create_app() -> FastAPI:$/", "language": "Python", "typeref": "typename:FastAPI", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "create_or_upsert_role", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    def create_or_upsert_role(payload: RoleUpsertModel) -> RoleModel:$/", "file": true, "language": "Python", "typeref": "typename:RoleModel", "kind": "function", "signature": "(payload: RoleUpsertModel)", "scope": "create_app", "scopeKind": "function"}, {"_type": "tag", "name": "description", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    description: Optional[str] = Field(None, description=\"Role description\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "RoleModel", "scopeKind": "class"}, {"_type": "tag", "name": "description", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    description: Optional[str] = Field(None, description=\"Role description\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "RoleUpsertModel", "scopeKind": "class"}, {"_type": "tag", "name": "get", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    def get(self, role_id: str) -> Optional[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "member", "signature": "(self, role_id: str)", "scope": "InMemoryRoleDAO", "scopeKind": "class"}, {"_type": "tag", "name": "get_role_adjacency", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    def get_role_adjacency($/", "file": true, "language": "Python", "typeref": "typename:List[RoleModel]", "kind": "function", "signature": "( userId: Optional[str] = Query( default=None, description=\"Optional user identifier to contextualize suggestions\", ), currentRoleId: Optional[str] = Query( default=None, description=\"Current role id to base adjacency suggestions on\", ), targetRoleId: Optional[str] = Query( default=None, description=\"Optional target role id to bias adjacency results\", ), limit: int = Query(default=20, ge=1, le=100, description=\"Max number of suggestions\"), )", "scope": "create_app", "scopeKind": "function"}, {"_type": "tag", "name": "get_role_by_id", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    def get_role_by_id(role_id: str) -> RoleModel:$/", "file": true, "language": "Python", "typeref": "typename:RoleModel", "kind": "function", "signature": "(role_id: str)", "scope": "create_app", "scopeKind": "function"}, {"_type": "tag", "name": "health_check", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    def health_check() -> Dict[str, str]:$/", "file": true, "language": "Python", "typeref": "typename:Dict[str,str]", "kind": "function", "signature": "()", "scope": "create_app", "scopeKind": "function"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    id: str = Field(..., description=\"Unique role identifier\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "RoleModel", "scopeKind": "class"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    id: str = Field(..., min_length=1, description=\"Unique role identifier\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "RoleUpsertModel", "scopeKind": "class"}, {"_type": "tag", "name": "list_roles", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    def list_roles($/", "file": true, "language": "Python", "typeref": "typename:List[RoleModel]", "kind": "function", "signature": "( limit: int = Query(500, ge=1, le=5000, description=\"Max number of roles to return\") )", "scope": "create_app", "scopeKind": "function"}, {"_type": "tag", "name": "logger", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^logger = logging.getLogger(__name__)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "metadata", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    metadata: Optional[Dict[str, Any]] = Field(None, description=\"Additional metadata\")$/", "language": "Python", "typeref": "typename:Optional[Dict[str, Any]]", "kind": "variable", "scope": "RoleModel", "scopeKind": "class"}, {"_type": "tag", "name": "metadata", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    metadata: Optional[Dict[str, Any]] = Field(None, description=\"Additional metadata\")$/", "language": "Python", "typeref": "typename:Optional[Dict[str, Any]]", "kind": "variable", "scope": "RoleUpsertModel", "scopeKind": "class"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    name: Optional[str] = Field(None, description=\"Role name\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "RoleModel", "scopeKind": "class"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    name: Optional[str] = Field(None, description=\"Role name\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "RoleUpsertModel", "scopeKind": "class"}, {"_type": "tag", "name": "openapi_tags", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^openapi_tags = [$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "source", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    source: Optional[str] = Field(None, description=\"Source of the data\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "RoleModel", "scopeKind": "class"}, {"_type": "tag", "name": "source", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    source: Optional[str] = Field(None, description=\"Source of the data\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "RoleUpsertModel", "scopeKind": "class"}, {"_type": "tag", "name": "upsert", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    def upsert(self, payload: RoleUpsertModel) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, payload: RoleUpsertModel)", "scope": "InMemoryRoleDAO", "scopeKind": "class"}, {"_type": "tag", "name": "version", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    version: Optional[str] = Field(None, description=\"Version of the data\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "RoleModel", "scopeKind": "class"}, {"_type": "tag", "name": "version", "path": "/home/kavia/workspace/code-generation/copy-of-mvp-career-platform---graph-db-214017-214037/CareerPlatformBackendAPI/src/api/main.py", "pattern": "/^    version: Optional[str] = Field(None, description=\"Version of the data\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "RoleUpsertModel", "scopeKind": "class"}], "hash": "615a09dd0b195c1ab0cf339cb40eea14", "format-version": 4, "code-base-name": "CareerPlatformBackendAPI", "filename": "CareerPlatformBackendAPI/src/api/main.py", "fields": [{"name": "app = create_app()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] description", "scope": "RoleModel", "scopeKind": "class", "description": "unavailable"}, {"name": "str id", "scope": "RoleModel", "scopeKind": "class", "description": "unavailable"}, {"name": "logger = logging.getLogger(__name__)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Dict[str, Any]] metadata", "scope": "RoleModel", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] name", "scope": "RoleModel", "scopeKind": "class", "description": "unavailable"}, {"name": "openapi_tags = [", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] source", "scope": "RoleModel", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] version", "scope": "RoleModel", "scopeKind": "class", "description": "unavailable"}]}